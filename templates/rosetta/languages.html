{% extends "rosetta/base.html" %}
{% load i18n %}
{% load url from future %}

{% block pagetitle %}{{block.super}} - {% trans "Language selection" %}{% endblock %}

{% block breadcumbs %}
    <div><a href="{% url 'rosetta-pick-file' %}">{% trans "Home" %}</a> &rsaquo; {% trans "Language selection" %}</div>
    {% if do_session_warn %}<p class="errornote session-warn">{% trans "Couldn't load the specified language file. This usually happens when using the Encrypted Cookies Session Storage backend on Django 1.4 or higher.<br/>Setting ROSETTA_STORAGE_CLASS = 'rosetta.storage.CacheRosettaStorage' in your settings file should fix this." %}</p>{% endif %}
{% endblock %}

{% block main %}
    <h1>&nbsp;</h1>
    <ul class="object-tools">
        <li class="nobubble">{% trans "Filter" %}:</li>
        <li{% ifequal rosetta_i18n_catalog_filter 'project' %} class="active"{% endifequal %}><a href="?filter=project">{% trans "Project" %}</a></li>
        <li{% ifequal rosetta_i18n_catalog_filter 'third-party' %} class="active"{% endifequal %}><a href="?filter=third-party">{% trans "Third party" %}</a></li>
        <li{% ifequal rosetta_i18n_catalog_filter 'django' %} class="active"{% endifequal %}><a href="?filter=django">Django</a></li>
        <li{% ifequal rosetta_i18n_catalog_filter 'all' %} class="active"{% endifequal %}><a href="?filter=all">{% trans "All" %}</a></li>
    </ul>

    {% if has_pos %}

<style>
td.progress {
  width: 310px;
}
td.progress div {
  position: relative;
  font-size: 0px;
  padding-right: 2px;
  height: 22px;
  background-color: #abb2bc;
  border-radius: 22px;
  background: linear-gradient(#9da5b0 0%, #b6bcc6 100%);
  box-shadow: inset 0px 1px 2px 0px rgba(0, 0, 0, 0.5), 0px 1px 0px 0px #FFF;
  display: block;
  width: 300px;
}
td.progress div span:first-child {
  border-top-left-radius: 22px;
  border-bottom-left-radius: 22px;
  border-left: 1px solid #4c8932;
}
td.progress div span:last-child {
  border-top-right-radius: 22px;
  border-bottom-right-radius: 22px;
  border-right: 1px solid #4c8932;
}
td.progress div span {
  position: relative;
  display: inline-block;
  overflow: hidden;
  height: 20px;
  background-color: #74d04c;
  box-shadow: inset 0px 1px 0px 0px #dbf383, inset 0px -1px 1px #58c43a;
  border-bottom: 1px solid #4c8932;
  border-top: 1px solid #4c8932;
}
td.progress div .done {
  background-color: #74d04c;
}
td.progress div .fuzzy {
  background-color: #d0ba4c;
  border-color: #897032;
  box-shadow: inset 0px 1px 0px 0px #f3cf83, inset 0px -1px 1px #c4a23a;
}
td.progress div .obsolete {
  background-color: #d0834c;
  border-color: #894932;
  box-shadow: inset 0px 1px 0px 0px #f38383, inset 0px -1px 1px #c43a3a;
}
</style>

    {% for lid,language,pos in languages %}
    {% if pos %}

        <div class="module">
            <h2>{{language}}</h2>
            <table cellspacing="0">
                <thead>
                    <tr>
                        <th>{% trans "Application" %}</th>
                        <th class="r">{% trans "Progress"%}</th>
                        <th>{% trans "Progress" %}</th>
                        <th>{% trans "File" %}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for app,path,po in pos %}
                    <tr class="{% cycle row1,row2 %}">
                        <td><a href="{% url 'rosetta-language-selection' lid forloop.counter0 %}{% if do_django %}?django{% endif %}{% if do_rosetta %}?rosetta{% endif %}">{{ app|title }}</a></td>
                        <td class="ch-progress r">{{po.percent_translated|floatformat:2}}%</td>

                        <td class="progress"><div>
                          {% for name,value in po.progress %}
                            {% if value > 4 %}
                            <span class="{{ name }}" style="width: {{ value|floatformat:2 }}%;">&nbsp;</span>
                            {% endif %}
                          {% endfor %}
                        </div></td>
                        <td class="hint">{{ path }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
    {% endfor %}
    {% else %}
    <h1>{% trans "Nothing to translate!" %}</h1>
    <p>{% trans "You haven't specified any languages in your settings file, or haven't yet generated a batch of translation catalogs." %}</p>
    <p>{% blocktrans with "http://docs.djangoproject.com/en/dev/topics/i18n/#topics-i18n" as i18n_doc_link  %}Please refer to <a href="{{i18n_doc_link}}">Django's I18N documentation</a> for a guide on how to set up internationalization for your project.{% endblocktrans %}</p>
    {% endif %}
{% endblock %}
